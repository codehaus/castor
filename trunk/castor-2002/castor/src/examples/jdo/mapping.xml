<!DOCTYPE databases PUBLIC "-//EXOLAB/Castor Mapping DTD Version 1.0//EN"
                           "http://castor.exolab.org/mapping.dtd">
<mapping>

  <!--  Mapping for ProductGroup  -->
  <class class-name="myapp.ProductGroup">
    <sql-table table-name="prod_group"/>
    <description>Product group</description>
    <identity field-ref="id"/>
    <field name="id">
      <sql-info name="id" />
    </field>
    <field name="name">
      <sql-info name="name" dirty="check" />
    </field>
  </class>


  <!--  Mapping for Product  -->
  <class class-name="myapp.Product">
    <sql-table table-name="prod"/>
    <description>Product definition</description>
    <identity field-ref="id"/>
    <field name="id">
      <sql-info name="id"/>
    </field>
    <field name="name">
      <sql-info name="name"/>
    </field>
    <field name="price" type="float">
      <sql-info name="price" type="double"/>
    </field>

    <!--  Product has reference to ProductGroup,
          many products may reference same group  -->
    <field name="group" type="myapp.ProductGroup">
      <sql-info name="group_id" />
    </field>

    <!-- Product has reference to ProductDetail
         many details per product  -->
    <field name="detail" type="myapp.ProductDetail" required="true"
           collection="vector" />

    <!-- Product has reference to Category with
         many-many relationship -->
<!--
    <field name="category" type="myapp.Category" required="true"
           collection="vector">
      <sql-info name="category_id"
                many-table="category_prod" many-key="prod_id" />
    </field>
-->
  </class>


  <!--  Mapping for Computer, extending Product  -->
  <class class-name="myapp.Computer" extends="myapp.Product">
    <sql-table table-name="computer"/>
    <description>Computer definition, extends generic product</description>
    <field name="cpu">
      <sql-info name="cpu"/>
    </field>
  </class>


  <!--  Mapping for Product Detail -->
  <class class-name="myapp.ProductDetail">
    <sql-table table-name="prod_detail"/>
    <description>Product detail</description>
    <identity field-ref="id"/>
    <field name="id">
      <sql-info name="id"/>
    </field>
    <field name="product" type="myapp.Product">
      <sql-info name="prod_id"/>
    </field>
    <field name="name">
      <sql-info name="name"/>
    </field>
  </class>


  <!--  Mapping for Category  -->
  <class class-name="myapp.Category">
    <sql-table table-name="category"/>
    <description>A product category, any number of products can belong to
                 the same category, a product can belong to any number of
                 categories</description>
    <identity field-ref="id" />
    <field name="id">
      <sql-info name="id" />
    </field>
    <field name="name">
      <sql-info name="name" />
    </field>
    <field name="product" type="myapp.Product" required="true"
           collection="vector">
      <sql-info name="prod_id"
                many-table="category_prod" many-key="category_id" />
    </field>
  </class>


</mapping>

